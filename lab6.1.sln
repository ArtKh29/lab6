#include <iostream>
#include <cstdlib>
using namespace std;

int* findZeroColumns(int** matrix, int rows, int cols, int& zeroCount) {
    zeroCount = 0;
    int* zeroColumns = (int*)calloc(cols, sizeof(int));

    for (int j = 0; j < cols; ++j) {
        for (int i = 0; i < rows; ++i) {
            if (matrix[i][j] == 0) {
                zeroColumns[zeroCount++] = j;
                break;
            }
        }
    }
    zeroColumns = (int*)realloc(zeroColumns, zeroCount * sizeof(int));
    return zeroColumns;
}

void removeColumns(int** matrix, int rows, int& cols, int* zeroColumns, int zeroCount) {
    if (zeroCount == 0) return;

    for (int k = 0; k < zeroCount; ++k) {
        int colToRemove = zeroColumns[k];

        for (int i = 0; i < rows; ++i) {
            for (int j = colToRemove; j < cols - 1; ++j) {
                matrix[i][j] = matrix[i][j + 1];
            }
        }

        for (int i = 0; i < rows; ++i) {
            matrix[i] = (int*)realloc(matrix[i], (cols - 1) * sizeof(int));
        }

        cols--;

        for (int m = k + 1; m < zeroCount; ++m) {
            zeroColumns[m]--;
        }
    }
}

void expandMatrix(int**& matrix, int& rows, int& cols, int A, int B, int C, int D) {
    int newRows = 2 + A;
    int newCols = 2 + B;

    matrix = (int**)realloc(matrix, newRows * sizeof(int*));

    for (int i = 0; i < 2; ++i) {
        matrix[i] = (int*)realloc(matrix[i], newCols * sizeof(int));
    }

    for (int i = 2; i < newRows; ++i) {
        matrix[i] = (int*)calloc(newCols, sizeof(int));
    }

    for (int i = 0; i < 2; ++i) {
        for (int j = 2; j < newCols; ++j) {
            matrix[i][j] = (i - 1) * C + (j - 1) * D;
        }
    }

    for (int i = 2; i < newRows; ++i) {
        for (int j = 0; j < newCols; ++j) {
            matrix[i][j] = (i - 1) * C + (j - 1) * D;
        }
    }

    rows = newRows;
    cols = newCols;
}

int pointerOperations() {
    double* a = new double;
    double* b = new double;

    cout << "a: ";
    cin >> *a;
    cout << "b: ";
    cin >> *b;
    cout << "a = " << *a << ", b = " << *b << endl;

    double* perA = a;
    double* perB = b;

    *perA *= 3;
    cout << "a = " << *a << ", b = " << *b << endl;

    double temp = *perA;
    *perA = *perB;
    *perB = temp;
    cout << "a = " << *a << ", b = " << *b << endl;

    delete a;
    delete b;

    return 0;
}

int main() {
    setlocale(LC_ALL, "Russian");
    int A, B, C, D;

    do {
        cout << "A: ";
        cin >> A;
    } while (A < 0);

    do {
        cout << "B: ";
        cin >> B;
    } while (B < 0);

    cout << "C: ";
    cin >> C;
    cout << "D: ";
    cin >> D;

    int rows = 2;
    int cols = 2;

    int** matrix = (int**)malloc(rows * sizeof(int*));
    for (int i = 0; i < rows; ++i) {
        matrix[i] = (int*)calloc(cols, sizeof(int));
    }

    matrix[0][0] = A;
    matrix[0][1] = B;
    matrix[1][0] = C;
    matrix[1][1] = D;

    cout << "Матрица 2x2:" << endl;
    for (int i = 0; i < rows; ++i) {
        for (int j = 0; j < cols; ++j) {
            cout << matrix[i][j] << "\t";
        }
        cout << endl;
    }

    expandMatrix(matrix, rows, cols, A, B, C, D);

    cout << "\nМатрица после расширения " << rows << "x" << cols << ":" << endl;
    for (int i = 0; i < rows; ++i) {
        for (int j = 0; j < cols; ++j) {
            cout << matrix[i][j] << "\t";
        }
        cout << endl;
    }

    int zeroCount;
    int* zeroColumns = findZeroColumns(matrix, rows, cols, zeroCount);

    if (zeroCount > 0) {
        cout << "Столбцы с нулями: ";
        for (int i = 0; i < zeroCount; ++i) {
            cout << zeroColumns[i] << " ";
        }
        cout << endl;

        removeColumns(matrix, rows, cols, zeroColumns, zeroCount);

        cout << "\nПосле удаления столбцов:" << endl;
        for (int i = 0; i < rows; ++i) {
            for (int j = 0; j < cols; ++j) {
                cout << matrix[i][j] << "\t";
            }
            cout << endl;
        }
    }
    else {
        cout << "\nНет столбцов с нулями." << endl;
    }

    int result = pointerOperations();

    free(zeroColumns);
    for (int i = 0; i < rows; ++i) {
        free(matrix[i]);
    }
    free(matrix);

    return 0;
}
